syntax = "proto3";
option csharp_namespace = "BlazorWasmGrpcBlog.Shared.Protos";
import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";
package blogproto;

service BlogProto{
	rpc GetPosts(google.protobuf.Empty) returns (Posts);
	rpc GetAuthors(google.protobuf.Empty) returns (Authors);
	rpc GetPost(GetPostQuery) returns (Post);
	rpc GetAuthor(GetAuthorQuery) returns (Author);
}

message Author {
	int32 author_id = 1;
	string name = 2;
	string created = 3; // DateTime String
}
message Authors {
	repeated Author authors_data = 1;
}

enum BlogStatus {
    HIDDEN = 0;
    PUBLISHED = 1;
}

message Post {
	int32 post_id = 1;
	Author author = 2; // One to One
	int32 author_id = 3;
	string title = 4;
	string content = 5;
	google.protobuf.Timestamp date = 6; // DateTime Timestamp
	BlogStatus blog_status = 7;
	repeated Tag tags = 8; // Post with many Tags
}
message Posts {
	repeated Post posts_data = 1;
}

/*
 Because of "message Post" with "repeated Tag tags" _and_ "message Tag" with "repeated Post posts"
 EF Core creates "PostTag" table automagically
*/

message Tag {
	string tag_id = 1;
	repeated Post posts = 2; // Tag with many Posts
}
message Tags {
	repeated Tag tags_data = 1;
}

message GetPostQuery {
	int32 id = 1;
}

message GetAuthorQuery {
	int32 id = 1;
}
